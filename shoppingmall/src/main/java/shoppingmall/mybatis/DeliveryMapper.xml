<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="Delivery">
	<sql id="columns">
		delivery_id, address, address_alias, receiver_name, receiver_phone, member_id
	</sql>
	
	<select id="selectall" resultType="Delivery">
		SELECT <include refid="columns"/> FROM delivery
	</select>
	
	<!-- join을 이용하여 배송지 정보 조회 시작 -->
	<resultMap id="joinMap" type="Delivery">
		<id 	column="delivery_id" 	property="delivery_id"/>
		<result column="address" 		property="address"/>
		<result column="address_alias"	property="address_alias"/>
		<result column="receiver_name" 	property="receiver_name"/>
		<result column="receiver_phone" property="receiver_phone"/>
		
		<association column="member_id" property="member" javaType="Member" 
					select="Member.select"/>
	</resultMap>
	
	<select id="select" parameterType="int" resultMap="joinMap">
		SELECT <include refid="columns"/> FROM delivery WHERE delivery_id = #{delivery_id} 
	</select>
	
	<select id="selectByMemberId" parameterType="int" resultMap="joinMap">
		SELECT <include refid="columns"/> FROM delivery WHERE member_id = #{member_id} 	
	</select>
	<!-- join을 이용하여 배송지 정보 조회 끝 -->
		
	<insert id="insert" parameterType="Delivery">
		INSERT INTO delivery(address, address_alias, receiver_name, receiver_phone, member_id)
		VALUES(#{address}, #{address_alias}, #{receiver_name}, #{receiver_phone}, #{member.member_id}
	</insert>
	
	<update id="update" parameterType="Delivery">
		UPDATE delivery
		SET address = #{address},  address_alias = #{address_alias}, receiver_name = #{receiver_name}, receiver_phone = #{receiver_phone}
		WHERE member_id = #{member_id};
	</update>
	
	<delete id="delete" parameterType="int">
		DELETE FROM delivery WHERE delivery_id = #{delivery_id}
	</delete>
	
</mapper>